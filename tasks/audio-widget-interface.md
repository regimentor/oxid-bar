# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è PulseAudio –≤–∏–¥–∂–µ—Ç–∞ –≤ –±–∞—Ä–µ

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—É–¥–∏–æ (–≥–ª–æ–±–∞–ª—å–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å, –≥—Ä–æ–º–∫–æ—Å—Ç—å –ø–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º) –≤ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–µ OxidBar. UI —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤ –º–æ–¥—É–ª–µ `audio`, –≤—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å backend —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ UI –º–æ–¥—É–ª–µ.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **UI –º–æ–¥—É–ª—å:** `modules/audio/src/ui/` - —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å backend
- **Backend –º–æ–¥—É–ª—å:** `modules/audio/src/backend/pulse/` - —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –§—É–Ω–∫—Ü–∏—è `build_ui` –≤ –º–æ–¥—É–ª–µ `audio` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑ –±–∞—Ä–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –≤–∏–¥–∂–µ—Ç

## –¶–µ–ª–∏

1. –†–∞—Å—à–∏—Ä–∏—Ç—å `AudioEvent` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–æ–±—ã—Ç–∏–π –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω—á–µ—Å–∫–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
2. –†–∞—Å—à–∏—Ä–∏—Ç—å `AudioCmd` –¥–ª—è –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
3. –°–æ–∑–¥–∞—Ç—å UI –º–æ–¥—É–ª—å –≤ `modules/audio/src/ui/` —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `build_ui`
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–∫–æ–Ω–∫—É –Ω–∞ –±–∞—Ä–µ –∏ –ø–æ–ø–∞–ø —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å backend –≤ UI –º–æ–¥—É–ª–µ
6. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–∂–µ—Ç –≤ –±–∞—Ä —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ `build_ui`

## –ó–∞–¥–∞—á–∏

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ AudioEvent –¥–ª—è —Å–æ–±—ã—Ç–∏–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏

**–§–∞–π–ª:** `modules/audio/src/backend/pulse/client.rs`

- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `AudioEvent` —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏:
  ```rust
  pub enum AudioEvent {
      // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å (sink)
      GlobalVolumeChanged {
          sink_index: u32,
          volume: u32,  // 0-100
          muted: bool,
      },
      // –ì—Ä–æ–º–∫–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (sink input)
      AppVolumeChanged {
          sink_input_index: u32,
          volume: u32,  // 0-100
          muted: bool,
          app_name: String,
      },
      // –°–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω
      AppsListUpdated {
          apps: Vec<OutputInfo>,
      },
      // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∞ (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
      GlobalVolumeReceived {
          sink_index: u32,
          volume: u32,
          muted: bool,
      },
      // –ì—Ä–æ–º–∫–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–∞ (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
      AppVolumeReceived {
          sink_input_index: u32,
          volume: u32,
          muted: bool,
          app_name: String,
      },
  }
  ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `AudioEvent` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è UI

---

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ AudioCmd –¥–ª—è –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–§–∞–π–ª:** `modules/audio/src/backend/pulse/client.rs`

- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `AudioCmd` —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏:
  ```rust
  pub enum AudioCmd {
      // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã
      AddOutput(OutputInfo),
      ChangeOutput(u32, OutputInfo),
      
      // –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –≥—Ä–æ–º–∫–æ—Å—Ç—å
      SetGlobalVolume {
          sink_index: u32,
          volume: u32,  // 0-100
      },
      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å mute –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
      ToggleGlobalMute {
          sink_index: u32,
      },
      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      SetAppVolume {
          sink_input_index: u32,
          volume: u32,  // 0-100
      },
      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å mute –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      ToggleAppMute {
          sink_input_index: u32,
      },
      // –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
      RequestGlobalVolume {
          sink_index: Option<u32>,  // None = default sink
      },
      // –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏—Ö –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
      RequestAppsList,
  }
  ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `AudioCmd` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é

---

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ backend –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π

**–§–∞–π–ª:** `modules/audio/src/backend/pulse/listen_pulse_backend.rs`

- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `lesten_pulse_backend` –¥–ª—è –ø—Ä–∏–µ–º–∞ `event_tx: mpsc::Sender<AudioEvent>`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è SINK (–¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏)
- [ ] –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ sink –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å `AudioEvent::GlobalVolumeChanged`
- [ ] –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ sink input –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å `AudioEvent::AppVolumeChanged`
- [ ] –ü—Ä–∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å `AudioEvent::GlobalVolumeReceived` –∏ `AudioEvent::AppVolumeReceived`

**–§–∞–π–ª:** `modules/audio/src/backend/pulse/client.rs`

- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `Client::start_listening` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥:
  - `SetGlobalVolume` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å —á–µ—Ä–µ–∑ PulseAudio API
  - `ToggleGlobalMute` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å mute —á–µ—Ä–µ–∑ PulseAudio API
  - `SetAppVolume` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - `ToggleAppMute` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å mute –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - `RequestGlobalVolume` - –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â—É—é –≥—Ä–æ–º–∫–æ—Å—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
  - `RequestAppsList` - –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** Backend –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è

---

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã UI –º–æ–¥—É–ª—è

**–§–∞–π–ª:** `modules/audio/src/ui/mod.rs`

- [ ] –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `ui` –≤ `modules/audio/src/lib.rs`: `pub mod ui;`
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `modules/audio/src/ui/mod.rs` —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º:
  ```rust
  pub mod widget;
  pub mod popup;
  
  pub use widget::build_ui;
  ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç—Ä—É–∫—Ç—É—Ä–∞ UI –º–æ–¥—É–ª—è —Å–æ–∑–¥–∞–Ω–∞

---

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞ –¥–ª—è –±–∞—Ä–∞ (–∏–∫–æ–Ω–∫–∞)

**–§–∞–π–ª:** `modules/audio/src/ui/widget.rs`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `AudioWidget` —Å –ø–æ–ª—è–º–∏:
  - `icon_container: Box` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–∫–æ–Ω–∫–∏ –Ω–∞ –±–∞—Ä–µ
  - `icon_label: Label` - label –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏/–≥—Ä–æ–º–∫–æ—Å—Ç–∏
  - `client: Rc<RefCell<Client>>` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å backend
  - `current_global_volume: u32` - —Ç–µ–∫—É—â–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è –≥—Ä–æ–º–∫–æ—Å—Ç—å
  - `is_global_muted: bool` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ mute
  - `popup: Option<AudioPopup>` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ø–∞–ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ú–µ—Ç–æ–¥—ã:**
- [ ] `new(icon_container: Box, client: Rc<RefCell<Client>>) -> Self` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞
  - –°–æ–∑–¥–∞—Ç—å `Label` –¥–ª—è –∏–∫–æ–Ω–∫–∏
  - –î–æ–±–∞–≤–∏—Ç—å CSS –∫–ª–∞—Å—Å `audio-widget-icon`
  - –î–æ–±–∞–≤–∏—Ç—å label –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] `update_icon(&self)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏
  - –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏–∫–æ–Ω–∫—É üîä/üîá –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç mute
  - –í–æ–∑–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- [ ] `handle_event(&mut self, event: AudioEvent)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
  - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å `GlobalVolumeChanged` - –æ–±–Ω–æ–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –≥—Ä–æ–º–∫–æ—Å—Ç—å
  - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å `GlobalVolumeReceived` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  - –í—ã–∑–≤–∞—Ç—å `update_icon()` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- [ ] `start_event_listener(&self)` - –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
  - –í –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ –∏–ª–∏ —á–µ—Ä–µ–∑ —Ç–∞–π–º–µ—Ä —á–∏—Ç–∞—Ç—å `client.event_channels.rx`
  - –í—ã–∑—ã–≤–∞—Ç—å `handle_event` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `MainContext` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ç–æ–∫–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–∫–æ–Ω–∫—É –Ω–∞ –±–∞—Ä–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

---

### 6. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ø–∞–ø–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é

**–§–∞–π–ª:** `modules/audio/src/ui/popup.rs`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `AudioPopup` —Å –ø–æ–ª—è–º–∏:
  - `popup_window: Popover` –∏–ª–∏ `Box` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ø–∞–ø–∞
  - `client: Rc<RefCell<Client>>` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å backend
  - `global_volume_scale: Scale` - —Å–ª–∞–π–¥–µ—Ä –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
  - `global_mute_button: Button` - –∫–Ω–æ–ø–∫–∞ mute/unmute
  - `apps_list: ListBox` –∏–ª–∏ `Box` - —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏—Ö –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
  - `apps: Vec<AppControl>` - —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ AppControl:**
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `AppControl` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç—å—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
  ```rust
  struct AppControl {
      app_name: String,
      sink_input_index: u32,
      volume_scale: Scale,
      mute_button: Button,
      volume_label: Label,
  }
  ```

**–ú–µ—Ç–æ–¥—ã AudioPopup:**
- [ ] `new(root: &Box, client: Rc<RefCell<Client>>) -> Self` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ø–∞–ø–∞
  - –°–æ–∑–¥–∞—Ç—å `Popover` –∏–ª–∏ `Box` —Å CSS –∫–ª–∞—Å—Å–æ–º `audio-popup`
  - –°–æ–∑–¥–∞—Ç—å —Å–ª–∞–π–¥–µ—Ä –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
  - –°–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É mute/unmute
  - –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
- [ ] `update_global_volume(&self, volume: u32, muted: bool)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞
  - –û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ mute
- [ ] `update_apps_list(&mut self, apps: Vec<OutputInfo>)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
  - –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `AppControl` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –î–æ–±–∞–≤–∏—Ç—å —Å–ª–∞–π–¥–µ—Ä—ã –∏ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [ ] `handle_event(&mut self, event: AudioEvent)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
  - –û–±–Ω–æ–≤–∏—Ç—å UI –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏–π
- [ ] `on_global_volume_changed(&self, value: f64)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å `AudioCmd::SetGlobalVolume`
- [ ] `on_global_mute_clicked(&self)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ mute
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å `AudioCmd::ToggleGlobalMute`
- [ ] `on_app_volume_changed(&self, sink_input_index: u32, value: f64)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å `AudioCmd::SetAppVolume`
- [ ] `on_app_mute_clicked(&self, sink_input_index: u32)` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ mute –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –û—Ç–ø—Ä–∞–≤–∏—Ç—å `AudioCmd::ToggleAppMute`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ø–∞–ø –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç—å—é –∏ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

### 7. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ build_ui

**–§–∞–π–ª:** `modules/audio/src/ui/widget.rs`

- [ ] –°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `build_ui`:
  ```rust
  pub fn build_ui(
      icon_container: &gtk4::Box,
      root: &gtk4::Box,
  ) -> anyhow::Result<()>
  ```
- [ ] –í —Ñ—É–Ω–∫—Ü–∏–∏:
  - –°–æ–∑–¥–∞—Ç—å `Client::new()`
  - –û–±–µ—Ä–Ω—É—Ç—å –∫–ª–∏–µ–Ω—Ç –≤ `Rc<RefCell<>>`
  - –°–æ–∑–¥–∞—Ç—å `AudioWidget` —Å –∏–∫–æ–Ω–∫–æ–π
  - –°–æ–∑–¥–∞—Ç—å `AudioPopup` —Å –ø–æ–ø–∞–ø–æ–º
  - –°–≤—è–∑–∞—Ç—å –≤–∏–¥–∂–µ—Ç –∏ –ø–æ–ø–∞–ø (–ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ø–∞–ø)
  - –ó–∞–ø—É—Å—Ç–∏—Ç—å PulseAudio listener –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
  - –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞ –∏ –ø–æ–ø–∞–ø–∞
  - –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ `AudioCmd::RequestGlobalVolume` –∏ `AudioCmd::RequestAppsList`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –§—É–Ω–∫—Ü–∏—è `build_ui` –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –≤–∏–¥–∂–µ—Ç –≤ –±–∞—Ä

---

### 8. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –º–æ–¥—É–ª—å audio

**–§–∞–π–ª:** `modules/audio/Cargo.toml`

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
  - `gtk4 = "0.10.3"` - –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
  - `glib = "0.19"` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MainContext –∏ —Ç–∞–π–º–µ—Ä–∞–º–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–¥—É–ª—å audio –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è UI

---

### 9. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –±–∞—Ä

**–§–∞–π–ª:** `bar/src/app.rs`

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç: `use audio::ui::build_ui;`
- [ ] –í –º–µ—Ç–æ–¥–µ `build_ui` –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `root`:
  - –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–∫–æ–Ω–∫–∏ –∞—É–¥–∏–æ: `let audio_icon_box = Box::new(Orientation::Horizontal, 0);`
  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ `root` –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥ Clock)
  - –í—ã–∑–≤–∞—Ç—å `audio::ui::build_ui(&audio_icon_box, &root)?;`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ê—É–¥–∏–æ –≤–∏–¥–∂–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–∞—Ä

---

### 10. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CSS —Å—Ç–∏–ª–µ–π

**–§–∞–π–ª:** `bar/resources/styles.css`

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `.audio-widget-icon`:
  ```css
  .audio-widget-icon {
      margin: 0 6px;
      padding: 0 8px;
      font-size: 14px;
      cursor: pointer;
  }
  ```
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `.audio-popup`:
  ```css
  .audio-popup {
      padding: 12px;
      min-width: 300px;
  }
  ```
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ø–æ–ø–∞–ø–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–∂–µ—Ç –∏ –ø–æ–ø–∞–ø –∏–º–µ—é—Ç —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥

---

### 11. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–§–∞–π–ª:** `docs/audio.md`

- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ UI –º–æ–¥—É–ª—è
- [ ] –û–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `build_ui` –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- [ ] –û–ø–∏—Å–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `AudioEvent` –∏ `AudioCmd`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `docs/bar.md`

- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞—É–¥–∏–æ –≤–∏–¥–∂–µ—Ç–∞
- [ ] –£–ø–æ–º—è–Ω—É—Ç—å –≤—ã–∑–æ–≤ `audio::ui::build_ui`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –∏ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—É–¥–∏–æ –≤–∏–¥–∂–µ—Ç

---

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏–π

**–î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Å–≤—è–∑—å:**
- **UI ‚Üí Backend:** –ö–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ `AudioCmd` (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏, mute)
- **Backend ‚Üí UI:** –°–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ `AudioEvent` (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**–í–∏–¥–∂–µ—Ç –Ω–∞ –±–∞—Ä–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –ò–∫–æ–Ω–∫—É üîä/üîá –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è mute
- –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç –≥—Ä–æ–º–∫–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü–æ–ø–∞–ø –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –°–ª–∞–π–¥–µ—Ä –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏ (0-100%)
- –ö–Ω–æ–ø–∫—É mute/unmute –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å:
  - –ò–º–µ–Ω–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –°–ª–∞–π–¥–µ—Ä–æ–º –≥—Ä–æ–º–∫–æ—Å—Ç–∏ (0-100%)
  - –ö–Ω–æ–ø–∫–æ–π mute/unmute

### –†–∞–±–æ—Ç–∞ —Å PulseAudio API

**–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `introspector.get_sink_info()` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `introspector.get_sink_input_info_list()` –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ `ctx.subscribe(InterestMaskSet::SINK | InterestMaskSet::SINK_INPUT)`

**–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `introspector.set_sink_volume_by_index()` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `introspector.set_sink_input_volume_by_index()` –¥–ª—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `introspector.set_sink_mute_by_index()` –∏ `introspector.set_sink_input_mute_by_index()` –¥–ª—è mute

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI

**Event-driven –ø–æ–¥—Ö–æ–¥:**
- Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ `event_channels.tx`
- UI –º–æ–¥—É–ª—å —á–∏—Ç–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ `event_channels.rx`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `MainContext::default().invoke()` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ç–æ–∫–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PulseAudio - –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å "‚Äî" –∏–ª–∏ —Å–∫—Ä—ã–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —á–µ—Ä–µ–∑ `logger::log_error()`
- Graceful degradation - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ –∞—É–¥–∏–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
- –ü—Ä–∏ –æ—à–∏–±–∫–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ - –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏ mute/unmute
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Å–ª–∞–π–¥–µ—Ä—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mute/unmute —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ PulseAudio
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –∞—É–¥–∏–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

---

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. **Backend:**
   - –†–∞—Å—à–∏—Ä–∏—Ç—å `AudioEvent` –∏ `AudioCmd`
   - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å backend –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è SINK

2. **UI –º–æ–¥—É–ª—å:**
   - –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥—É–ª—è `modules/audio/src/ui/`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `AudioWidget` (–∏–∫–æ–Ω–∫–∞ –Ω–∞ –±–∞—Ä–µ)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `AudioPopup` (–ø–æ–ø–∞–ø —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `build_ui`

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `modules/audio/Cargo.toml`
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `bar/src/app.rs`
   - –î–æ–±–∞–≤–∏—Ç—å CSS —Å—Ç–∏–ª–∏

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å backend –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ UI –º–æ–¥—É–ª–µ (`modules/audio/src/ui/`)
- UI –º–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Client` –∏–∑ backend –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –ø–æ—Ç–æ–∫–∞ PulseAudio –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `MainContext::default().invoke()`
- –ü–æ–ø–∞–ø –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ `Popover` (–ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω –∫ –∏–∫–æ–Ω–∫–µ) –∏–ª–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Popover` –¥–ª—è –±–æ–ª–µ–µ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–∏–¥–∞
- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

